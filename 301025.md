//livro: scrum nas trincheiras (pdf)

src:
components:
addpostform
albumlist
layout
login
privateroute
productcard
productlist

context:
authcontext
themecontext

pages:
products
usuariodetalhe
usuarios

app.css
app.jsx
index.css
main.jsx
--------------------------------

import { useState } from "react";

function AddPostForm(){

    // const [form, setForm] = useState({title: "", body: ""})
    const [title, setTitle] = useState('')
    const [body, setBody] = useState('')
    const [status, setStatus] = useState('idle')
    //idle, sending, success, error

    const handleSubmit = async (e) => {
        e.preventDefaut(); //previne atualização de tela indesejada
        setStatus("sending");
        try{
            const response = await fetch('https://jsonplaceholder.typicode.com/albums',{
                method: "POST",
                headers: {"Content-Type": "application/json"},
                body: JSON.stringify({
                    title,
                    body,
                    userId: 1
                })
        });

        if (!response.ok) throw new Error()
            const newPost = await response.json()
            console.log(newPost)

            setStatus('success');
            setTitle("")
            setBody("")
        

        } catch {
            setStatus("error")

        }

    }
    return (
        <form on onSubmit={handleSubmit}>
            <input type="text" 
            value={title}
            onChange={(e)=> setTitle(e.target.value)}/>

            <input type="text" 
            value={body}
            onChange={(e)=> setTitle(e.target.value)}/>

            <button type= "submit" disabled={status === "sending"}>
                {status === "sending" ? "Enviando..." : "Adicionar"}
            </button>
            {status === "error" && <p>Ocorreu um erro</p>}
            {status === "success" && <p>Enviado com sucesso</p>}
        </form>
    )
}
export default AddPostForm;
---------
import React, { useState, useEffect } from 'react';

function AlbumList() {
    const [posts, setPosts] = useState([]);
    const [loading, setLoading] = useState(true);
    const [error, setError] = useState(null);

    useEffect(() => {
        // Definimos uma função async dentro do useEffect
        const fetchData = async () => {
            try {
                const response = await fetch('https://jsonplaceholder.typicode.com/albums');
                if (!response.ok) {
                    throw new Error('A resposta da rede não foi ok');
                }
                const data = await response.json();
                setPosts(data);
            } catch (err) {
                setError(err.message);
            } finally {
                setLoading(false);
            }
        };
        fetchData(); // Chamamos a função
    }, []);

    if (loading) return <p>Carregando álbuns...</p>;
    if (error) return <p>Falha ao buscar os álbuns.</p>;

    return (
        <div>
            <h1>Lista de Álbuns</h1>
            <ul>
                {posts.map((post) => (
                    <li key={post.id}>{post.title}</li>
                ))}
            </ul>
        </div>
    );
}

export default AlbumList;

// Desafio (Opcional):
//Converta sua lógica de busca de dados em um hook customizado useFetch e utilize-o no seu componente AlbumList.
    // function useFetch(postID){
    //     const 
    // }
-------------------------------------
import {Link, Outlet} from "react-router-dom";
import { useAuth } from "../context/AuthContext";
import { ThemeContext } from "../context/ThemeContext"
import { useContext } from "react";

function Layout(){
 const { user, logout} = useAuth();
 const { theme, handleTheme } = useContext(ThemeContext)

 return (
    <>
    <div
    style={{
        backgroundColor: theme === "light" ? "#fff" : "#333",
        color: theme === "light" ? "#fff" : "#333"
    }}
    >
    <header>
        <nav>
            <Link to= "/">Usuários</Link> | {" "}
            <Link to= "/produtos">Produtos</Link>
        </nav>
        <div>
            { user ? (
                 <>
                Olá, {user.name}
                <button onClick={logout}>Sair</button>
                </>
                ) : (
                    <Link to= "/login">Login</Link>
                )
            }
            <button noClick={handleTheme}>Alternar tema</button>

        </div>
    </header>
    
    <hr />
    <main>
        <Outlet/>
    </main>
    <footer>
        
    </footer>
    </div>
    </>
 )
    
}
export default Layout;
--------------
import { useAuth } from "../context/AuthContext";
import { useNavigate } from "react-router-dom";


function Login(){

        const { login } = useAuth();
        const navigate = useNavigate();

        const handleLogin = () => {
            login({ name:"helio", email: "helio@email.com" })
            navigate("/");
            
        }

    return (
        <div>
            <h1>Login</h1>
            <p>Faça login para acessar</p>
            <button onClick={handleLogin}>Entrar</button>
        </div>
    )
}
export default Login;
---------------
import {Navigate, Outlet} from 'react-router-dom';
import { useAuth } from '../context/AuthContext';

//simulando autorização
// const useAuth = () => {
//     const userIsloggesdIn = true;
//     return userIsloggesdIn;
// }

function PrivateRoute(){

    const { user } = useAuth();
    //se logado, rederiza rota filha - outlet
    //se não vai para login
    return user ? <Outlet /> : <Navigate to= "/login"/>
}

export default PrivateRoute;
------------
//crie um componente `ProductCard` que receba via props
// - `name` (nome do produto)
// - `price` (preço)
// - `image` (URL da imagem)
// e use dentro de um `ProductList` para enderizar varios produtos

function ProductCard ({name, price, image}) {
  return(
    <>
        <h2>{name}</h2>
        <h3>R$ {price}</h3>
        <img src={image} alt={name} />
    </>
  );
}

export default ProductCard;
------------
//Lista de produtos

import ProductCard from "./ProductCard";
function ProductList() {
    const products = [
        {
            id: 1,
            name: "Notebook", price: 4000,
            image: "https://placehold.co/200x150?text=Notebook"
        },
        {
            id: 2,
            name: "Smartphone", price: 3000,
            image: "https://placehold.co/200x150?text=Smartphone"
        }
    ];
    return (
        <>
            {products.map(product => (
                <ProductCard key={product.id}
                    name={product.name}
                    price={product.price}
                    image={product.image} />
            ))}
        </>
    )
}
export default ProductList;
-----------------
import { createContext, useContext, useState } from "react";

//criando contexto
const AuthContext = createContext()

//provider que envolve a aplicação / valida se está logado ou não
export function AuthProvider({ children }){
    
    const[user, setUser] = useState(null);
    const login = (userData) => setUser(userData);
    const logout = () => setUser(null);

    return(
        <AuthContext.Provider value={{user, login, logout}}>
            {children}
        </AuthContext.Provider>
    )
}

//hook para acessar
export function useAuth(){
    return useContext(AuthContext)
}
---------------------
}
